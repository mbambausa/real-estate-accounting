---
// src/components/auth/SigninForm.astro
import Button from '@components/ui/Button.astro';
import Alert from '@components/ui/Alert.astro';

interface Props {
  error?: string; // Error message to display
  // Add other props if needed, e.g., for initial email value
}

const { error } = Astro.props;
---

<form 
  method="POST" 
  action="/api/auth/callback/credentials?redirect=true&callbackUrl=/app/dashboard"
  class="space-y-6"
>
  {/* CSRF Token Handling:
    Auth.js v5 (used by auth-astro) typically handles CSRF protection for its POST routes
    (like /api/auth/callback/credentials) automatically, often by checking the Origin header
    or using a double-submit cookie pattern managed by the library.
    Manually adding a CSRF token, especially from an outdated cookie name like "next-auth.csrf-token",
    is incorrect and likely to cause issues.
    If auth-astro requires manual CSRF token submission (which is less common for its core routes),
    its documentation would specify how to obtain the correct token.
    For now, we assume it's handled by the library and the input is removed.
  */}
  
  {error && (
    <Alert type="error" dismissible={true}> {/* Made error alert dismissible */}
      {error}
    </Alert>
  )}
  
  <div>
    <label for="email-signin" class="block text-sm font-medium text-gray-700 mb-1">
      Email Address
    </label>
    <input
      id="email-signin"
      name="email"
      type="email"
      autocomplete="email"
      required
      placeholder="you@example.com"
      class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
    />
  </div>
  
  <div>
    <label for="password-signin" class="block text-sm font-medium text-gray-700 mb-1">
      Password
    </label>
    <input
      id="password-signin"
      name="password"
      type="password"
      autocomplete="current-password"
      required
      placeholder="••••••••"
      class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
    />
  </div>
  
  <div class="flex items-center justify-between text-sm">
    <div class="flex items-center">
      <input
        id="remember_me_signin"
        name="remember_me"
        type="checkbox"
        class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"
      />
      <label for="remember_me_signin" class="ml-2 block text-gray-700">
        Remember me
      </label>
    </div>
    
    <div>
      <a href="/auth/forgot-password" class="font-medium text-primary-600 hover:text-primary-500">
        Forgot your password?
      </a>
    </div>
  </div>
  
  <div>
    <Button type="submit" variant="primary" fullWidth={true} size="md">
      Sign In
    </Button>
  </div>
</form>
